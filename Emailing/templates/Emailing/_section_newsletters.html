{% extends "_section.html" %}
{% load i18n pagination_tags %}

{% block section_title %}
  {% trans "Newsletters" %}
{% endblock %}
  
{% block section_data %}
  {% if newsletters %}
  {% autopaginate newsletters 10 %}
  <table class="newsletters">
    <tr>
      <th>{% trans "Newsletter" %}</th><th>{% trans "Sending" %}</th>
    </tr>
  {% for nl in newsletters %}
    <tr>
      <td><a href="{% url coop_cms_edit_newsletter nl.id %}">{{nl.subject}}</a>
      </td>
      <td>
        {% if nl.emailing_set.count %}
          <table>
          {% for e in nl.emailing_set.all %}
            <tr><td>
              <a href="{% url emailing_view e.id %}">{{e.get_info}}: {{e.get_contacts|length}} {% trans "recipients" %}</a>
            </td></tr>
          {% endfor %}
          </table>
        {% else %}
          &nbsp;
        {% endif %}
      </td>
      
  </tr>
  {% endfor %}
  </table>
  {% paginate %}
  {% else %}
    {% trans "No newsletters" %}
  {% endif %}
{% endblock %}

{% block section_action %}
  <a class="colorbox-form" href="{% url emailing_new_newsletter %}">{% trans "Add" %}</a>
{% endblock %}
