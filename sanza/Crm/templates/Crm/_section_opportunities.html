{% extends "sanza/_bs_section.html" %}
{% load i18n pagination_tags %}

{% block section_title %}
  {% trans "Opportunities" %}
{% endblock %}
  
{% block section_data %}
{% if opportunities %}
{% if all_opportunities %}{% autopaginate opportunities 25 %}{% endif %}
<table class="table table-striped">
  <tr>
    <th>{% trans "Name" %}</th>
    <th>{% trans "Type" %}</th>
    <th>{% trans "Status" %}</th>
    <th>{% trans "Actions" %}</th>
    <th>{% trans "Date" %}</th>
    <th></th>
    <th></th>
  </tr>
  {% for o in opportunities %}
  <tr class="{% if o.ended%}old-opportunity{% endif %} {% if forloop.counter|divisibleby:2 %}even{% else %}odd{% endif %}">
    <td>{{o.name}}</td>
    <td>{{o.type|default:"&nbsp;"}}</td>
    <td>{{o.status|default:"&nbsp;"}}</td>
    <td>{{o.action_set.count}}</td>
    <td>{{ o.get_start_date|date:'j F Y'|default:'&nbsp;'}} : {{ o.get_end_date|date:'j F Y'|default:'&nbsp;'}}</td>
   
    <td>
      <a rel="{% url "crm_toggle_opportunity_bookmark" o.id %}">
        <span class="glyphicon glyphicon-{% if o.display_on_board %}star{% else %}star-empty{% endif %}"></span>
      </a>
    </td>
   
    <td>
      <a href="{% url "crm_view_opportunity" o.id %}">
        <span class="glyphicon glyphicon-cog"></span>
      </a>
    </td>
  </tr>
  {% endfor %}
</table>
{% if all_opportunities %}{% paginate %}{% endif %}
{% endif %}
{% endblock %}

{% block section_buttons %}
  {% if not entity and not contact %}
  <li><a href="{% url "crm_add_opportunity" %}">{% trans "Add" %}</a></li>
  <li><a href="{% url "crm_all_opportunities_by" "date" %}" class="{% if ordering == "date" %}disabled{% endif %}">{% trans "Order by date" %}</a></li>
  <li><a href="{% url "crm_all_opportunities_by" "name" %}" class="{% if ordering == "name" %}disabled{% endif %}">{% trans "Order by name" %}</a></li>
  <li><a href="{% url "crm_all_opportunities_by" "type" %}" class="{% if ordering == "type" %}disabled{% endif %}">{% trans "Order by type" %}</a></li>
  <li><a href="{% url "crm_all_opportunities_by" "status" %}" class="{% if ordering == "status" %}disabled{% endif %}">{% trans "Order by status" %}</a></li>
  {% endif %}

{% endblock %}
