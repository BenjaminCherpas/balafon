{% extends "sanza/_bs_section.html" %}
{% load i18n sanza_utils thumbnail %}

{% block section_header_extra_class %}main-section-header{% endblock %}

{% block section_title %}
<div class="row">
  <div class="col-md-5">
    <div class="logo-container">
      <img {{contact.get_photo_center_style}} src="{{contact.get_safe_photo}}"/>
    </div>
    <div style="display: inline-block; vertical-align: middle;">
    {{contact.fullname}}
    {% if contact.same_as %}
      {% if contact == contact.same_as.main_contact %}
        <span class="glyphicon glyphicon-certificate highlight" title="Is main contact"> </span>
    {% else %}
      <a class="colorbox-form" href="{% url "crm_make_main_contact" contact.id contact.id %}">
        <span class="glyphicon glyphicon-certificate disabled"  title="Make main contact"> </span>
      </a>
    {% endif %}
    {% endif %}
    <div class="section-subtitle">{{contact.title}}</div>
    </div>
  </div>
  <div class="col-md-2 text-center" style="vertical-align: middle; margin-top: 10px;">
    {% if not contact.entity.is_single_contact %}
      <span class="glyphicon glyphicon-chevron-right"></span>
    {% endif %}
  </div>
  <div class="col-md-5">
    {% if not contact.entity.is_single_contact %}
    <div class="logo-container">
      <img {{contact.entity.get_logo_center_style}} class="contact-entity-logo" src="{{contact.entity.get_safe_logo}}">
    </div>
    <a href="{% url "crm_view_entity" contact.entity.id %}" class="contact-entity-info">
      {{contact.entity}}
    </a>
    {% endif %}
  </div>
</div>
{% endblock %}

{% block section_data %}
<div class="row">
  <div class="col-md-4">
    <table class="table">
      <tr><td>
        <span class="glyphicon glyphicon-home"></span> {{contact.get_address_fields|join:'<br /><span class="glyphicon glyphicon-home" style="color:transparent"></span> '}}
      </td></tr>
      <tr><td>
        <span class="glyphicon glyphicon-envelope"></span> <a href="mailto:{{contact.get_email}}">{{contact.get_email}}</a>
      </td></tr>
      <tr><td>
        <span class="glyphicon glyphicon-earphone"></span> {{contact.get_phone}}
      </td></tr>
      <tr><td>
        <span class="glyphicon glyphicon-phone"></span> {{contact.mobile}}
      </td></tr>
      <tr><td>
        <span class="glyphicon glyphicon-briefcase"></span> {{contact.job}}
      </td></tr>
    </table>
  </div>
  
  <div class="col-md-7">
    
    <div class="note" style="margin-bottom: 5px;">
      
      <span class="contenteditable" contenteditable="true" rel="{% url "auto_save_data" "contact" "notes" contact.id %}">
        {{contact.notes|linebreaksbr|default:"&nbsp;"}}
      </span>
      
      <!-- <span contenteditable=true>{{contact.notes|linebreaksbr|default:"&nbsp;"}}</span>-->
    </div>
    
    <div class="">{% trans "Roles" %}: 
    {% with contact.get_roles as roles %}
      {% for role in roles %}<span class="label label-primary">{{role}}</span>{% endfor %}
    {% endwith %}
    </div>
    
    {% include "Crm/_contact_groups.html" %}
    
    {% with contact.get_custom_fields as custom_fields %}
    {% if custom_fields %}
        {% include "Crm/_custom_fields.html" with instance=contact  model="contact" %}
    {% endif %}
    {% endwith %}
    
  </div>
  
  <div class="col-md-1">
    <table class="table micro-table table-striped">
      {% if contact.has_left %}
      <tr><td colspan="2"><b>{% trans "This contact has left." %}</b></td></tr>
      {% endif %}
      <tr><td><b>{% trans "ADD_DT" %}</b> {{contact.created|date:"d/m/Y"}}</td></tr>
      <tr><td><b>{% trans "UPD_DT" %}</b> {{contact.modified|date:"d/m/Y"}}</td></tr>
      {% if entity.type %}
      <tr><th>{% trans "Type" %}</th><td>{{entity.type}}</td></tr> 
      {% endif %}
    </table>
  </div>
</div>  

{% endblock %}

{% block section_buttons %}
    <li><a class="colorbox-form" href="{% url "crm_edit_contact" contact.id %}">{% trans "Edit" %}</a></li>
    <li><a class="colorbox-form" href="{% url "crm_delete_contact" contact.id%}">{% trans "Delete" %}</a></li>
    <li><a class="colorbox-form" href="{% url "crm_change_contact_entity" contact.id%}">{% trans "Reassign" %}</a></li>
    <li><a class="" href="{% url "crm_edit_custom_fields" "contact" contact.id %}">{% trans "Edit fields" %}</a></li>
{% endblock %}


